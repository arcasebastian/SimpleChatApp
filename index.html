<!DOCTYPE html>
<html lang="en" style="min-height: 100vh">
<head>
    <meta charset="UTF-8">
    <title>Hello</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
</head>
<body style="background-color: #cf3e3f; min-height: 100vh">
<div class="container">
    <div class="mt-2 bg-dark" style="position: relative;top: 20px">
        <h1 class="text-center p-3">Send Message</h1>
        <form action="#" class="m-3" id="send-message">
            <div class="form-floating mb-3">
                <input type="text" id="name" class="form-control" placeholder="Name">
                <label for="name">Name</label>
            </div>
            <button type="submit" class="btn btn-success">Send</button>
        </form>
        <div class="card">
            <div class="card-header text-center">
                <h2>Chat</h2>
            </div>
            <ul class="list-group p-3 messages">
            </ul>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
        crossorigin="anonymous"></script>
<script>
    const messageForm = document.querySelector('#send-message');
    messageForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const name = document.querySelector('#name').value;
        if (!name) return;
        addMesagges({name, text: "hello"})
    })

    function addMesagges(message){
        const messagesArea = document.querySelector('.messages');
        messagesArea.append(formatMesage(message));
    }

    function formatMesage({name, text})
    {
        const listElement = document.createElement('li');
        listElement.classList.add("list-group-item", "d-flex", "justify-content-between", "align-items-start")
        const messageElement = document.createElement('div');
        messageElement.classList.add("ms-2", "me-auto")
        const messageHeader = document.createElement('div');
        messageHeader.classList.add("fw-bold");
        messageHeader.innerHTML = `<h4>${name}</h4>`;
        const time = document.createElement('span');
        time.innerText = new Date().toLocaleString();
        messageElement.append(messageHeader, text);
        listElement.append(messageElement, time)
        return listElement;
    }

    async function getMessages(){
        const newMessages = await axios.get('/messages')
        for(let message of newMessages.data){
            addMesagges(message)
        }
    }

    getMessages()
</script>
</body>
</html>
